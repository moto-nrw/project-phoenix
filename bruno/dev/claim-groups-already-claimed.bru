meta {
  name: Claim Already Claimed Group (Error Test)
  type: http
  seq: 203
}

post {
  url: {{baseUrl}}/api/active/groups/25/claim
  body: json
  auth: none
}

headers {
  Authorization: Bearer {{accessToken}}
  Content-Type: application/json
}

body:json {
  {
    "role": "supervisor"
  }
}

docs {
  # Claim Already Claimed Group (Error Test)

  Tests that claiming an already-claimed group returns proper error.

  ## Run After
  - claim-groups-claim-schulhof.bru (first claim)
  - This test attempts to claim again (should fail)

  ## Expected Response
  Either:
  1. 409 Conflict - "staff member already supervising this group"
  2. 200 OK - If a different teacher claims it (valid scenario)
}

tests {
  test("Should return 200 or 409", function() {
    const status = res.getStatus();
    expect([200, 409]).to.include(status);
  });

  test("If 409: Should indicate already supervising", function() {
    if (res.getStatus() === 409) {
      const body = res.getBody();
      expect(body).to.have.property('status', 'error');
      // Error message should indicate duplicate supervision
    }
  });

  test("If 200: Different teacher claimed successfully", function() {
    if (res.getStatus() === 200) {
      expect(res.getBody()).to.have.property('status', 'success');
    }
  });
}
