meta {
  name: Claim Schulhof Active Group
  type: http
  seq: 201
}

post {
  url: {{baseUrl}}/api/active/groups/25/claim
  body: json
  auth: none
}

headers {
  Authorization: Bearer {{accessToken}}
  Content-Type: application/json
}

body:json {
  {
    "role": "supervisor"
  }
}

docs {
  # Claim Schulhof Active Group

  Allows a teacher to claim supervision of the Schulhof active group.

  ## Prerequisites
  - Valid teacher authentication token
  - Schulhof active group exists (ID: 25)
  - Teacher is not already supervising this group

  ## Expected Response
  ```json
  {
    "status": "success",
    "data": {
      "id": 123,
      "staff_id": 1,
      "group_id": 25,
      "role": "supervisor",
      "start_date": "2025-10-07T20:00:00Z"
    },
    "message": "Successfully claimed supervision"
  }
  ```

  ## Notes
  - If teacher already supervises this group, returns error
  - If group doesn't exist or has ended, returns error
  - Role defaults to "supervisor" if not provided
}

tests {
  test("Should return 200 OK or 409 Conflict", function() {
    const status = res.getStatus();
    expect([200, 409]).to.include(status);
  });

  test("Success: Should create supervisor record", function() {
    if (res.getStatus() === 200) {
      expect(res.getBody()).to.have.property('status', 'success');
      const data = res.getBody().data;
      expect(data).to.have.property('staff_id');
      expect(data).to.have.property('group_id', 25);
      expect(data).to.have.property('role', 'supervisor');
    }
  });

  test("Already claimed: Should return meaningful error", function() {
    if (res.getStatus() === 409) {
      const body = res.getBody();
      expect(body).to.have.property('status', 'error');
    }
  });
}
