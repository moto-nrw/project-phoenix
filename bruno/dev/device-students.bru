meta {
  name: Device Students List
  type: http
  seq: 1
}

get {
  url: {{baseUrl}}/api/iot/students
  body: none
  auth: none
}

headers {
  Authorization: Bearer {{deviceApiKey}}
  X-Staff-PIN: {{staffPIN}}
}

tests {
  test("Students endpoint accessible", function() {
    expect(res.getStatus()).to.equal(200);
    expect(res.getBody()).to.have.property('status', 'success');
    expect(res.getBody()).to.have.property('data');
    expect(res.getBody().data).to.be.an('array');
  });
  
  test("Response includes student information", function() {
    const students = res.getBody().data;
    if (students.length > 0) {
      expect(students[0]).to.have.property('student_id');
      expect(students[0]).to.have.property('first_name');
      expect(students[0]).to.have.property('last_name');
    }
  });
}

script:post-response {
  if (res.status === 200) {
    const students = res.body.data;
    console.log("✅ Students endpoint accessible");
    console.log("Found " + students.length + " supervised students");
    if (students.length > 0) {
      console.log("Sample student:", students[0].first_name + " " + students[0].last_name);
      if (students[0].rfid_tag) {
        console.log("RFID tag:", students[0].rfid_tag);
      }
    } else {
      console.log("⚠️  Teacher has no supervised students");
    }
  } else {
    console.log("❌ Students endpoint failed");
    console.log("Status:", res.status);
    console.log("Response:", res.body);
  }
}