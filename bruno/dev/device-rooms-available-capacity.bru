meta {
  name: Device Rooms Available - Capacity Filter
  type: http
  seq: 9
}

get {
  url: {{baseUrl}}/api/iot/rooms/available
  body: none
  auth: none
}

query {
  capacity: 100
}

headers {
  Authorization: Bearer {{deviceApiKey}}
  X-Staff-PIN: {{staffPIN}}
}

tests {
  test("Status code is 200", function() {
    expect(res.getStatus()).to.equal(200);
  });
  
  test("Response has success status", function() {
    expect(res.getBody().status).to.equal("success");
  });
  
  test("Response has data array", function() {
    expect(res.getBody().data).to.be.an("array");
  });
  
  test("Response contains rooms", function() {
    const rooms = res.getBody().data;
    expect(rooms.length).to.be.greaterThan(0);
  });
  
  test("All rooms have capacity field", function() {
    const rooms = res.getBody().data;
    rooms.forEach(room => {
      expect(room).to.have.property("capacity");
      expect(room.capacity).to.be.a("number");
    });
  });
}

docs {
  # Device Rooms Available - Capacity Filter Test
  
  Tests the capacity filtering functionality of the RFID device rooms endpoint.
  
  **Query Parameters:**
  - `capacity: 100` - Only rooms with capacity 100 or more
  
  **Expected Response:**
  All returned rooms should have capacity >= 100.
}