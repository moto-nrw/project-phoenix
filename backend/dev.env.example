# Backend Development Environment Variables
# This file is used for local backend development
# Copy this file to dev.env and replace placeholders with actual values

PORT=8080
LOG_LEVEL=DEBUG
LOG_TEXTLOGGING=false

# Database Connection
# IMPORTANT: Docker setup uses SSL (sslmode=require). Choose based on your setup:
#
# Option 1: Docker development (RECOMMENDED - secure)
# Requires running: cd config/ssl/postgres && ./create-certs.sh
# DB_DSN=postgres://postgres:postgres@localhost:5432/postgres?sslmode=require
#
# Option 2: Local development without SSL (less secure, easier setup)
# Use this only for local development if SSL certificates are not set up
DB_DSN=postgres://postgres:postgres@localhost:5432/postgres?sslmode=require

# Test database connection (used by automated tests)
TEST_DB_DSN=postgres://postgres:postgres_test@localhost:5432/postgres_test?sslmode=require

AUTH_LOGIN_URL=http://localhost:8080/login
AUTH_LOGIN_TOKEN_LENGTH=8
AUTH_LOGIN_TOKEN_EXPIRY=11m
AUTH_JWT_SECRET=your_jwt_secret_at_least_32_chars_long
AUTH_JWT_EXPIRY=15m
AUTH_JWT_REFRESH_EXPIRY=24h

# Test JWT secret (used by automated tests)
AUTH_JWT_TEST_SECRET=test_secret_key_for_testing_only

ENABLE_CORS=false

# CORS Security Configuration
# Leave unset or empty to allow all origins (current behavior - development only!)
# For production, set to comma-separated list of allowed origins:
# CORS_ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com
# CORS_ALLOWED_ORIGINS=

# Rate Limiting Configuration
# Enable rate limiting to prevent abuse and brute force attacks
RATE_LIMIT_ENABLED=false
# General API rate limits (requests per minute)
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=10
# Stricter limits for authentication endpoints
RATE_LIMIT_AUTH_REQUESTS_PER_MINUTE=5

# Security Logging Configuration
# Enable logging of security events (auth failures, rate limits, etc.)
SECURITY_LOGGING_ENABLED=false

# Admin Account (for initial setup)
ADMIN_EMAIL=admin@example.com
ADMIN_PASSWORD=your_secure_admin_password
APP_ENV=development

# Email configuration
# SMTP settings for sending password reset and invitation emails
# Port 465: Implicit SSL/TLS (recommended) - Port 587: STARTTLS (alternative)
EMAIL_SMTP_HOST=smtp.example.com
EMAIL_SMTP_PORT=465
EMAIL_SMTP_USER=your_email@example.com
EMAIL_SMTP_PASSWORD=your_smtp_password
EMAIL_FROM_NAME=Your Organization
EMAIL_FROM_ADDRESS=noreply@example.com
# In production environments FRONTEND_URL must use https:// scheme
FRONTEND_URL=http://localhost:3000
INVITATION_TOKEN_EXPIRY_HOURS=48
PASSWORD_RESET_TOKEN_EXPIRY_MINUTES=30

# Scheduled Tasks Configuration
# Enable automated cleanup of expired visit data
CLEANUP_SCHEDULER_ENABLED=true
# Time to run daily cleanup (24-hour format, e.g., "02:00" for 2 AM)
CLEANUP_SCHEDULER_TIME=02:00
# Cleanup timeout in minutes
CLEANUP_SCHEDULER_TIMEOUT_MINUTES=30

# Session Lifecycle Management
# Enable automatic end of all active sessions at end of day (default: enabled)
SESSION_END_SCHEDULER_ENABLED=true
# Time to automatically end all active sessions (24-hour format, e.g., "18:00" for 6 PM)
SESSION_END_TIME=18:00
# Session end timeout in minutes
SESSION_END_TIMEOUT_MINUTES=10

# Abandoned Session Cleanup
# Enable automatic cleanup of abandoned sessions (no activity AND device offline)
SESSION_CLEANUP_ENABLED=true
# How often to check for abandoned sessions (minutes)
SESSION_CLEANUP_INTERVAL_MINUTES=15
# Minutes of inactivity before a session is considered abandoned
# Activity = student RFID scan OR device ping
SESSION_ABANDONED_THRESHOLD_MINUTES=60

# Device Authentication
# Global PIN for all OGS staff to authenticate devices
OGS_DEVICE_PIN=1234
